<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Authentication &amp; Authorization &mdash; BEdita 4.1.0 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/api_methods.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Shell commands" href="shell.html" />
    <link rel="prev" title="Objects in BEdita" href="bedita_objects.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> BEdita
          </a>
              <div class="version">
                4.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="bedita_objects.html">Objects in BEdita</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Authentication &amp; Authorization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#user-authentication">User authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application-identification">Application identification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#authorization">Authorization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#endpoint-permissions">Endpoint permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#object-permissions">Object permissions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#oauth2">OAuth2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="shell.html">Shell commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="endpoints/index.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BEdita</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Authentication &amp; Authorization</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/authorization.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="authentication-authorization">
<h1>Authentication &amp; Authorization<a class="headerlink" href="#authentication-authorization" title="Permalink to this headline">¶</a></h1>
<p>BEdita4 is a multi-application system: it is designed to handle different client applications requests performed by multiple users on the same <a class="reference internal" href="glossary.html#term-project"><span class="xref std std-term">project</span></a>.</p>
<p>For every request application and user roles should be identified: each application may have its own grants, and each user also depending on <a class="reference internal" href="glossary.html#term-role"><span class="xref std std-term">role</span></a> assignement.</p>
<p>As a general rule: anonymous read operations are absolutely possibile, for write operations at least the user performing the request must be identified.</p>
<p>To handle these scenarios please have a look at <a class="reference internal" href="configuration.html#configuration-security"><span class="std std-ref">Security</span></a> configuration and set <code class="docutils literal notranslate"><span class="pre">blockAnonymousUsers</span></code> or <code class="docutils literal notranslate"><span class="pre">blockAnonymousApps</span></code> flags accordingly.</p>
<div class="section" id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<div class="section" id="user-authentication">
<h3>User authentication<a class="headerlink" href="#user-authentication" title="Permalink to this headline">¶</a></h3>
<p>User authentication is performed using <a class="reference internal" href="glossary.html#term-2"><span class="xref std std-term">JWT</span></a> standard. You may have a look a the official <a class="reference external" href="https://jwt.io/introduction/">JWT introduction</a> for a more detailed explanation of the standard.</p>
<p>Basically JWT enables a <strong>token based authentication flow</strong> using an <a class="reference internal" href="glossary.html#term-access-token"><span class="xref std std-term">access token</span></a> to access resources
and an opaque <a class="reference internal" href="glossary.html#term-refresh-token"><span class="xref std std-term">refresh token</span></a> to renew the access token.</p>
<p>See <a class="reference internal" href="endpoints/auth.html"><span class="doc">Authentication /auth</span></a> endpoint documentation on how you can retrieve the JWT tokens with a standard username and password user authentication.
Once the token is retrieved it can be used on every request in the <code class="docutils literal notranslate"><span class="pre">Authorization</span></code> HTTP header this way:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span>Authorization: Bearer &lt;token&gt;
</pre></div>
</div>
</div>
<div class="section" id="application-identification">
<h3>Application identification<a class="headerlink" href="#application-identification" title="Permalink to this headline">¶</a></h3>
<p>Client applications instead are identified using a simple <strong>API KEY</strong> mechanism.
Through <a class="reference internal" href="endpoints/admin.html"><span class="doc">Administration /admin</span></a> endpoint it’s possible to set and retrieve an API KEY for each application registered for a project.</p>
<p>On each request you may set the application’s API KEY using the <code class="docutils literal notranslate"><span class="pre">X-Api-Key</span></code> HTTP header</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span>X-Api-Key: &lt;api-key&gt;
</pre></div>
</div>
<p>We prefer to talk about application <em>identification</em> instead of <em>authentication</em> because it’s a weak authentication system: web or mobile client applications may expose this api key, or at least secrecy is not guaranteed.
This is somehow similar to <code class="docutils literal notranslate"><span class="pre">implicit</span> <span class="pre">grant</span></code> in OAuth2.</p>
<p>The only real authentication is <em>user authentication</em>: you must rely on that for a <strong>secure</strong> authentication.</p>
</div>
</div>
<div class="section" id="authorization">
<h2>Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h2>
<p>Once user and application performing a request are identified, also as anonymous, the requested operation may or may not be allowed depending on the outcome of the following checks:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>anonymous</strong> user and application settings: depending on <a class="reference internal" href="configuration.html#configuration-security"><span class="std std-ref">Security</span></a> configuration anonymous requests can be blocked with 401 or 403 responses</p></li>
<li><p><strong>endpoint</strong> permissions: each endpoint may allow or deny a request from a user using a client application</p></li>
<li><p><strong>object</strong> permissions: at the most granular level a single <a class="reference internal" href="glossary.html#term-object"><span class="xref std std-term">object</span></a> may or may not be accessible or modifiable to the requesting user and application</p></li>
</ul>
</div></blockquote>
<div class="section" id="endpoint-permissions">
<h3>Endpoint permissions<a class="headerlink" href="#endpoint-permissions" title="Permalink to this headline">¶</a></h3>
<p>Operation grants on endpoints can be controlled through a set of rules involving roles, applications and permission types.</p>
<p>Possible values for endpoint, role and application in these rules are:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>endpoint</strong> endpoint id or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> for every endpoint</p></li>
<li><p><strong>role</strong> role id or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> for every role or anonymous user</p></li>
<li><p><strong>application</strong> application id or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> for every application</p></li>
</ul>
</div></blockquote>
<p>Instead <code class="docutils literal notranslate"><span class="pre">permission</span> <span class="pre">type</span></code> may have four different values for read operations (GET) or write operations (POST, PATCH, DELETE):</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>false</strong> <code class="docutils literal notranslate"><span class="pre">(0b00)</span></code>: no permissions granted</p></li>
<li><p><strong>true</strong> <code class="docutils literal notranslate"><span class="pre">(0b11)</span></code>: full permissions granted</p></li>
<li><p><strong>mine</strong> <code class="docutils literal notranslate"><span class="pre">(0b01)</span></code>: permissions granted only on <strong>my</strong> resources, i.e. resources belonging to the autenticated user</p></li>
<li><p><strong>block</strong> <code class="docutils literal notranslate"><span class="pre">(0b10)</span></code>: no permissions granted, and override all other permissions</p></li>
</ul>
</div></blockquote>
<p>The first two bit, starting from right, are for the read operations (GET) and the other two for the write operations (POST, PATCH, DELETE):</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(0b0000)</span></code>: <strong>false</strong> for read [characters <cite>00</cite> on the right] and <strong>false</strong> for write [characters <cite>00</cite> in the middle, shifting by 2 positions]</p></li>
</ul>
</div></blockquote>
<p>The relative integer number is used on the <code class="docutils literal notranslate"><span class="pre">permission</span> <span class="pre">type</span></code> column.</p>
<p>To better understand how these rules work an example is given below:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 12%" />
<col style="width: 16%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>endpoint</p></th>
<th class="head"><p>role</p></th>
<th class="head"><p>application</p></th>
<th class="head"><p>permission</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>documents</p></td>
<td><p>NULL</p></td>
<td><p>ios-app</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">5</span>&#160; <span class="pre">(0b0101)</span></code> write: mine - read: mine</p></td>
</tr>
<tr class="row-odd"><td><p>documents</p></td>
<td><p>manager</p></td>
<td><p>backend</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">15</span> <span class="pre">(0b1111)</span></code> write: true - read: true</p></td>
</tr>
<tr class="row-even"><td><p>payments</p></td>
<td><p>app</p></td>
<td><p>NULL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">10</span> <span class="pre">(0b1010)</span></code> write: block - read: block</p></td>
</tr>
<tr class="row-odd"><td><p>events</p></td>
<td><p>reader</p></td>
<td><p>web-app</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">12</span> <span class="pre">(0b1100)</span></code> write: true - read: false</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><ul class="simple">
<li><p>for every role (NULL) on <code class="docutils literal notranslate"><span class="pre">/documents</span></code> endpoint through <code class="docutils literal notranslate"><span class="pre">ios-app</span></code> application only resources belonging to authenticated user may be read and written</p></li>
<li><p>users with <code class="docutils literal notranslate"><span class="pre">manager</span></code> role accessing <code class="docutils literal notranslate"><span class="pre">/documents</span></code> with <code class="docutils literal notranslate"><span class="pre">backend</span></code> application are able to read and modify write every resource</p></li>
<li><p>users with <code class="docutils literal notranslate"><span class="pre">app</span></code> role accessing <code class="docutils literal notranslate"><span class="pre">/payments</span></code> with every application are not allowed to read or write anything</p></li>
<li><p>users with <code class="docutils literal notranslate"><span class="pre">reader</span></code> role on <code class="docutils literal notranslate"><span class="pre">/events</span></code> usgin <code class="docutils literal notranslate"><span class="pre">web-app</span></code> application have a read-only access</p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="endpoints/admin.html"><span class="doc">Administration /admin</span></a> endpoint reference on how you may set these permission rules.</p>
<p>Keep in mind that altough powerful these rules must be applied very carefully like firewall network rules: it is quite easy to cause unintended side effects like blocking every operation or allow dangerous ones.</p>
</div>
<div class="section" id="object-permissions">
<h3>Object permissions<a class="headerlink" href="#object-permissions" title="Permalink to this headline">¶</a></h3>
<p>This feature is not yet implemented.</p>
</div>
</div>
<div class="section" id="oauth2">
<h2>OAuth2<a class="headerlink" href="#oauth2" title="Permalink to this headline">¶</a></h2>
<p>And what about <strong>OAuth2</strong>?
At this moment BEdita4 is not (yet) an OAuth2 compliant server solution even if many OAuth2 concepts like <a class="reference internal" href="glossary.html#term-access-token"><span class="xref std std-term">access token</span></a>
and <a class="reference internal" href="glossary.html#term-refresh-token"><span class="xref std std-term">refresh token</span></a> are already implemented.</p>
<p>Nonetheless integration with <strong>OAuth2</strong> Authorization services is already in development stage.
A server compliant implementation will follow.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bedita_objects.html" class="btn btn-neutral float-left" title="Objects in BEdita" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="shell.html" class="btn btn-neutral float-right" title="Shell commands" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Channelweb Srl, Chialab Srl.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>